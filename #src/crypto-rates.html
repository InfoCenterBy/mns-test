<!DOCTYPE html>
<html lang="ru">
@@include('_head.html',{
"title":"Курсы цифровых знаков (токенов)"
})

<body>
  <div class="wrapper">
    @@include('_header.html',{})
    <main class="page page__decor">
      <div class="content px-2">
        <nav aria-label="breadcrumb">
          <div class='container'>
            <ol class="breadcrumb">
              <li class="breadcrumb-item mr-3">
                <a href="index.html">
                  Главная<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item mr-3">
                <a href="services.html">
                  Сервисы<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item active" aria-current="page">Курсы цифровых знаков (токенов)</li>
            </ol>
          </div>
        </nav>
        <div class="item-content">
          <div class="container">
            <section class="item-block px-md-4 px-2 py-4">
              <h4 class="item-block__title h4 mb-4">
                Криптовалюты
              </h4>
              <div class="row">
                <div class="col-12 col-md-4 col-lg-3 d-flex">
                  <div class="d-flex gap-4 flex-column p-4 shadow rounded-4 w-100">
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/btc.svg" alt="">
                        <span class="fs-24 fw-semibold">BTC</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="fs-18 fw-semibold">345 281,95 BYN</span>
                        <span class="fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/eth.svg" alt="">
                        <span class="fs-24 fw-semibold">ETH</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="fs-18 fw-semibold">96,9670 BYN</span>
                        <span class="fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/xrp.svg" alt="">
                        <span class="fs-24 fw-semibold">XRP</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="fs-18 fw-semibold">8,5001 BYN</span>
                        <span class="fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-8 col-lg-9 d-flex">
                  <div class="p-4 shadow rounded-4 w-100">
                    <div class="d-flex gap-4">
                      <div>
                        <p class="fs-14 fw-semibold mb-2">Токен</p>
                        <div class="dropdown dropdown-search-token">
                          <button class="dropdown-toggle dropdown-btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            BTC
                          </button>
                          <ul class="dropdown-menu dropdown-content">
                            <li class="dropdown-search">
                              <input class="dropdown-search-input" type="text">
                              <i class="dropdown-search-icon bi bi-search"></i>
                            </li>
                            <li><a class="dropdown-item" href="#">BTC</a></li>
                            <li><a class="dropdown-item" href="#">XRP</a></li>
                            <li><a class="dropdown-item" href="#">USDT</a></li>
                            <li><a class="dropdown-item" href="#">SOL</a></li>
                            <li><a class="dropdown-item" href="#">SHIB</a></li>
                            <li><a class="dropdown-item" href="#">BTC</a></li>
                            <li><a class="dropdown-item" href="#">XRP</a></li>
                            <li><a class="dropdown-item" href="#">USDT</a></li>
                            <li><a class="dropdown-item" href="#">SOL</a></li>
                            <li><a class="dropdown-item" href="#">SHIB</a></li>
                          </ul>
                        </div>
                      </div>
                      <div>
                        <p class="fs-14 fw-semibold mb-2">Месяц</p>
                        <div class="dropdown">
                          <button class="dropdown-toggle dropdown-btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Август
                          </button>
                          <ul class="dropdown-menu dropdown-content">
                            <li><a class="dropdown-item" href="#">Август</a></li>
                            <li><a class="dropdown-item" href="#">Сентябрь</a></li>
                            <li><a class="dropdown-item" href="#">Октябрь</a></li>
                            <li><a class="dropdown-item" href="#">Ноябрь</a></li>
                            <li><a class="dropdown-item" href="#">Декабрь</a></li>
                            <li><a class="dropdown-item" href="#">Январь</a></li>
                            <li><a class="dropdown-item" href="#">Февраль</a></li>
                            <li><a class="dropdown-item" href="#">Март</a></li>
                            <li><a class="dropdown-item" href="#">Апрель</a></li>
                            <li><a class="dropdown-item" href="#">Май</a></li>
                            <li><a class="dropdown-item" href="#">Июнь</a></li>
                            <li><a class="dropdown-item" href="#">Июль</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div class="chart-container w-100 position-relative overflow-hidden mt-4 h-100">
                      <div class="chart" style="position: absolute; width: 100%; height: 100%;">
                      </div>
                    </div>
                  </div>
                </div>
              </div>


              <h4 class="fs-20 fw-semibold border-bottom pb-2 mt-64">
                Архив курсов криптовалют в BYN
              </h4>

              <div class="row">
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Токен</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li class="dropdown-search">
                          <input class="dropdown-search-input" type="text">
                          <i class="dropdown-search-icon bi bi-search"></i>
                        </li>
                        <li><a class="dropdown-item" href="#">Август</a></li>
                        <li><a class="dropdown-item" href="#">Сентябрь</a></li>
                        <li><a class="dropdown-item" href="#">Октябрь</a></li>
                        <li><a class="dropdown-item" href="#">Ноябрь</a></li>
                        <li><a class="dropdown-item" href="#">Декабрь</a></li>
                        <li><a class="dropdown-item" href="#">Январь</a></li>
                        <li><a class="dropdown-item" href="#">Февраль</a></li>
                        <li><a class="dropdown-item" href="#">Март</a></li>
                        <li><a class="dropdown-item" href="#">Апрель</a></li>
                        <li><a class="dropdown-item" href="#">Май</a></li>
                        <li><a class="dropdown-item" href="#">Июнь</a></li>
                        <li><a class="dropdown-item" href="#">Июль</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Год</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item" href="#">Август</a></li>
                        <li><a class="dropdown-item" href="#">Сентябрь</a></li>
                        <li><a class="dropdown-item" href="#">Октябрь</a></li>
                        <li><a class="dropdown-item" href="#">Ноябрь</a></li>
                        <li><a class="dropdown-item" href="#">Декабрь</a></li>
                        <li><a class="dropdown-item" href="#">Январь</a></li>
                        <li><a class="dropdown-item" href="#">Февраль</a></li>
                        <li><a class="dropdown-item" href="#">Март</a></li>
                        <li><a class="dropdown-item" href="#">Апрель</a></li>
                        <li><a class="dropdown-item" href="#">Май</a></li>
                        <li><a class="dropdown-item" href="#">Июнь</a></li>
                        <li><a class="dropdown-item" href="#">Июль</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Месяц</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item" href="#">Август</a></li>
                        <li><a class="dropdown-item" href="#">Сентябрь</a></li>
                        <li><a class="dropdown-item" href="#">Октябрь</a></li>
                        <li><a class="dropdown-item" href="#">Ноябрь</a></li>
                        <li><a class="dropdown-item" href="#">Декабрь</a></li>
                        <li><a class="dropdown-item" href="#">Январь</a></li>
                        <li><a class="dropdown-item" href="#">Февраль</a></li>
                        <li><a class="dropdown-item" href="#">Март</a></li>
                        <li><a class="dropdown-item" href="#">Апрель</a></li>
                        <li><a class="dropdown-item" href="#">Май</a></li>
                        <li><a class="dropdown-item" href="#">Июнь</a></li>
                        <li><a class="dropdown-item" href="#">Июль</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Дата</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item" href="#">Август</a></li>
                        <li><a class="dropdown-item" href="#">Сентябрь</a></li>
                        <li><a class="dropdown-item" href="#">Октябрь</a></li>
                        <li><a class="dropdown-item" href="#">Ноябрь</a></li>
                        <li><a class="dropdown-item" href="#">Декабрь</a></li>
                        <li><a class="dropdown-item" href="#">Январь</a></li>
                        <li><a class="dropdown-item" href="#">Февраль</a></li>
                        <li><a class="dropdown-item" href="#">Март</a></li>
                        <li><a class="dropdown-item" href="#">Апрель</a></li>
                        <li><a class="dropdown-item" href="#">Май</a></li>
                        <li><a class="dropdown-item" href="#">Июнь</a></li>
                        <li><a class="dropdown-item" href="#">Июль</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div class="d-flex gap-3 flex-wrap mt-4">
                <button class="button mobile-w-100">Применить</button>
                <button class="button button-empty mobile-w-100">Сбросить</button>
              </div>

              <div class="table-crypto-container">
                <table class="table-crypto">
                  <thead>
                    <tr>
                      <td>Токен</td>
                      <td>01.08.2025</td>
                      <td>02.08.2025</td>
                      <td>03.08.2025</td>
                      <td>04.08.2025</td>
                      <td>05.08.2025</td>
                      <td>06.08.2025</td>
                      <td>07.08.2025</td>
                      <td>01.08.2025</td>
                      <td>02.08.2025</td>
                      <td>03.08.2025</td>
                      <td>04.08.2025</td>
                      <td>05.08.2025</td>
                      <td>06.08.2025</td>
                      <td>07.08.2025</td>
                      <td>01.08.2025</td>
                      <td>02.08.2025</td>
                      <td>03.08.2025</td>
                      <td>04.08.2025</td>
                      <td>05.08.2025</td>
                      <td>06.08.2025</td>
                      <td>07.08.2025</td>
                      <td>01.08.2025</td>
                      <td>02.08.2025</td>
                      <td>03.08.2025</td>
                      <td>04.08.2025</td>
                      <td>05.08.2025</td>
                      <td>06.08.2025</td>
                      <td>07.08.2025</td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/btc.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/eth.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/xrp.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/usdt.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>
          </div>
        </div>
      </div>
    </main>
    @@include('_footer.html',{})
  </div>
  <script type="text/javascript" src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <!-- @@include('_popup.html',{}) -->

  @@include('_js.html',{})
  <script>

    // const chartOptions = { layout: { textColor: 'black', background: { type: 'solid', color: 'white' } }, attributionLogo: false };
    // const chart = LightweightCharts.createChart(document.querySelector('.chart'), chartOptions);
    // const areaSeries = chart.addSeries(LightweightCharts.AreaSeries, { lineColor: '#014A37', topColor: '#007A65', bottomColor: 'rgba(0,122,101, 0.28)' });

    // const data = [{ value: 0, time: 1642425322 }, { value: 8, time: 1642511722 }, { value: 10, time: 1642598122 }, { value: 20, time: 1642684522 }, { value: 3, time: 1642770922 }, { value: 43, time: 1642857322 }, { value: 41, time: 1642943722 }, { value: 43, time: 1643030122 }, { value: 56, time: 1643116522 }, { value: 46, time: 1643202922 }];

    // areaSeries.setData(data);

    // chart.timeScale().fitContent();

  </script>

  //
  <script>
    //   document.addEventListener('DOMContentLoaded', function () {
    //     const dropdown = document.querySelector('.dropdown-search-token');
    //     const searchInput = dropdown.querySelector('.dropdown-search-input');
    //     const dropdownItems = dropdown.querySelectorAll('.dropdown-item');
    //     const dropdownToggle = dropdown.querySelector('.dropdown-toggle');

    //     // Добавляем элемент для сообщения "нет результатов"
    //     const noResults = document.createElement('li');
    //     noResults.className = 'dropdown-no-results';
    //     noResults.textContent = 'Ничего не найдено';
    //     dropdown.querySelector('.dropdown-content').appendChild(noResults);

    //     // Функция поиска
    //     function performSearch() {
    //       const searchTerm = searchInput.value.toLowerCase().trim();
    //       let visibleCount = 0;

    //       dropdownItems.forEach(item => {
    //         const text = item.textContent.toLowerCase();
    //         if (text.includes(searchTerm)) {
    //           item.classList.remove('d-none');
    //           visibleCount++;
    //         } else {
    //           item.classList.add('d-none');
    //         }
    //       });

    //       // Показываем/скрываем сообщение "нет результатов"
    //       if (visibleCount === 0 && searchTerm !== '') {
    //         noResults.style.display = 'block';
    //       } else {
    //         noResults.style.display = 'none';
    //       }
    //     }

    //     // Обработчик ввода в поле поиска
    //     searchInput.addEventListener('input', performSearch);

    //     // Обработчик клика по элементу
    //     dropdownItems.forEach(item => {
    //       item.addEventListener('click', function (e) {
    //         e.preventDefault();
    //         const value = this.getAttribute('data-value');
    //         const text = this.textContent;

    //         // Обновляем текст кнопки
    //         dropdownToggle.textContent = text;

    //         // Сбрасываем поиск
    //         searchInput.value = '';
    //         performSearch();
    //       });
    //     });

    //     // Сбрасываем поиск при закрытии дропдауна
    //     dropdown.addEventListener('hidden.bs.dropdown', function () {
    //       searchInput.value = '';
    //       performSearch();
    //     });
    //   });
    // </script>
  <script>
    let chart = null;
    let areaSeries = null;
    let currentCurrency = 'BTC';
    let currentMonth = 'Август';
    let allData = {};

    // Мок данные (замените на реальные данные с бэкенда)
    const mockData = [
      {
        "SOL": {
          "Август": { "01": "213.123", "02": "213.222", "03": "215.500", "04": "210.800" },
          "Сентябрь": { "01": "220.100", "02": "218.500", "03": "222.300", "04": "219.700" }
        }
      },
      {
        "BTC": {
          "Август": { "01": "45000.50", "02": "45200.75", "03": "44800.25", "04": "45500.00" },
          "Сентябрь": { "01": "46000.00", "02": "45800.50", "03": "46200.75", "04": "45900.25" }
        }
      },
      {
        "ETH": {
          "Август": { "01": "2800.25", "02": "2820.50", "03": "2780.75", "04": "2850.00" },
          "Сентябрь": { "01": "2900.00", "02": "2880.25", "03": "2920.50", "04": "2890.75" }
        }
      }
    ];

    // Конвертируем месяц в номер
    function monthToNumber(month) {
      const months = {
        'Январь': '01', 'Февраль': '02', 'Март': '03', 'Апрель': '04',
        'Май': '05', 'Июнь': '06', 'Июль': '07', 'Август': '08',
        'Сентябрь': '09', 'Октябрь': '10', 'Ноябрь': '11', 'Декабрь': '12'
      };
      return months[month] || '01';
    }

    // Конвертируем дату в timestamp
    function dateToTimestamp(dateString) {
      return Math.floor(new Date(dateString).getTime() / 1000);
    }

    // Обрабатываем мок данные в удобный формат
    function processMockData(data) {
      const result = {};
      data.forEach(currencyData => {
        const currencyName = Object.keys(currencyData)[0];
        result[currencyName] = {};

        Object.entries(currencyData[currencyName]).forEach(([month, days]) => {
          result[currencyName][month] = Object.entries(days).map(([day, value]) => ({
            time: dateToTimestamp(`2024-${monthToNumber(month)}-${day}`),
            value: parseFloat(value)
          }));
        });
      });
      return result;
    }

    // Инициализация графика
    function initChart() {
      const chartOptions = {
        layout: {
          textColor: 'black',
          background: { type: 'solid', color: 'white' }
        },
        grid: {
          vertLines: { color: '#f0f0f0' },
          horzLines: { color: '#f0f0f0' }
        },
        attributionLogo: false,
        width: document.querySelector('.chart').clientWidth,
        height: 500
      };

      chart = LightweightCharts.createChart(document.querySelector('.chart'), chartOptions);
      areaSeries = chart.addSeries(LightweightCharts.AreaSeries, {
        lineColor: '#014A37',
        topColor: '#007A65',
        bottomColor: 'rgba(0,122,101, 0.28)',
        lineWidth: 2
      });

      // Респонсив размер графика
      window.addEventListener('resize', () => {
        chart.applyOptions({
          width: document.querySelector('.chart').clientWidth
        });
      });
    }

    // Debounce для поиска
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Инициализация дропдауна валют
    function initCurrencyDropdown() {
      const dropdown = document.querySelector('.dropdown-search-token');
      const searchInput = dropdown.querySelector('.dropdown-search-input');
      const dropdownItems = dropdown.querySelectorAll('.dropdown-item');
      const dropdownToggle = dropdown.querySelector('.dropdown-toggle');

      // Добавляем элемент для "нет результатов"
      const noResults = document.createElement('li');
      noResults.className = 'no-results';
      noResults.textContent = 'Валюты не найдены';
      dropdown.querySelector('.dropdown-content').appendChild(noResults);

      // Функция поиска
      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();
        let visibleCount = 0;

        dropdownItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text.includes(searchTerm)) {
            item.classList.remove('hidden');
            visibleCount++;
          } else {
            item.classList.add('hidden');
          }
        });

        noResults.style.display = visibleCount === 0 && searchTerm !== '' ? 'block' : 'none';
      }

      // Обработчики событий
      searchInput.addEventListener('input', debounce(performSearch, 300));

      dropdownItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          const value = this.getAttribute('data-value');
          const text = this.textContent;

          dropdownToggle.textContent = text;
          currentCurrency = value;

          // Сбрасываем поиск
          searchInput.value = '';
          performSearch();

          // Обновляем график
          updateChart();
        });
      });

      // Сбрасываем поиск при закрытии
      dropdown.addEventListener('hidden.bs.dropdown', function () {
        searchInput.value = '';
        performSearch();
      });
    }

    // Инициализация дропдауна месяцев
    function initMonthDropdown() {
      const dropdown = document.querySelector('.dropdown:last-child');
      const dropdownItems = dropdown.querySelectorAll('.dropdown-item');
      const dropdownToggle = dropdown.querySelector('.dropdown-toggle');

      dropdownItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          const value = this.getAttribute('data-value');
          const text = this.textContent;

          dropdownToggle.textContent = text;
          currentMonth = value;

          // Обновляем график
          updateChart();
        });
      });
    }

    // Получаем данные для графика
    function getChartData() {
      const currencyData = allData[currentCurrency];
      if (!currencyData) {
        console.warn(`Данные для валюты ${currentCurrency} не найдены`);
        return [];
      }

      const monthData = currencyData[currentMonth];
      if (!monthData) {
        console.warn(`Данные для месяца ${currentMonth} не найдены`);
        return [];
      }

      return monthData;
    }

    // Обновляем заголовок графика
    function updateChartTitle() {
      // Удаляем существующий заголовок
      const existingTitle = document.querySelector('.chart-title');
      if (existingTitle) {
        existingTitle.remove();
      }

      // Создаем новый заголовок
      const title = document.createElement('div');
      title.className = 'chart-title';
      title.style.cssText = `
    text-align: center;
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
    color: #333;
  `;
      title.textContent = `${currentCurrency} - ${currentMonth} 2024`;

      document.querySelector('.chart-container').insertBefore(title, document.querySelector('.chart'));
    }

    // Обновление данных графика
    function updateChart() {
      const chartData = getChartData();
      areaSeries.setData(chartData);
      chart.timeScale().fitContent();
      updateChartTitle();
    }

    // Метод для обновления данных из API
    async function updateDataFromAPI(apiData) {
      allData = processMockData(apiData);
      updateChart();
    }

    // Основная функция инициализации
    function init() {
      // Обрабатываем мок данные
      allData = processMockData(mockData);

      // Инициализируем график
      initChart();

      // Инициализируем дропдауны
      initCurrencyDropdown();
      initMonthDropdown();

      // Первоначальное обновление графика
      updateChart();
    }

    // Инициализация когда DOM загружен
    document.addEventListener('DOMContentLoaded', init);

    // Функция для загрузки данных с API (пример)
    async function loadChartDataFromAPI() {
      try {
        const response = await fetch('/api/chart-data');
        const apiData = await response.json();
        updateDataFromAPI(apiData);
      } catch (error) {
        console.error('Ошибка загрузки данных:', error);
      }
    }

    // Экспортируем функции для использования извне
    window.chartFunctions = {
      updateChart,
      updateDataFromAPI,
      loadChartDataFromAPI,
      setCurrency: function (currency) {
        currentCurrency = currency;
        updateChart();
      },
      setMonth: function (month) {
        currentMonth = month;
        updateChart();
      }
    };
  </script>
  </script>
</body>

</html>