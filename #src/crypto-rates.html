<!DOCTYPE html>
<html lang="ru">
@@include('_head.html',{
"title":"Курсы цифровых знаков (токенов)"
})

<body>
  <div class="wrapper">
    @@include('_header.html',{})
    <main class="page page__decor">
      <div class="content px-2">
        <nav aria-label="breadcrumb">
          <div class='container'>
            <ol class="breadcrumb">
              <li class="breadcrumb-item mr-3">
                <a href="index.html">
                  Главная<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item mr-3">
                <a href="services.html">
                  Сервисы<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item active" aria-current="page">Курсы цифровых знаков (токенов)</li>
            </ol>
          </div>
        </nav>
        <div class="item-content">
          <div class="container">
            <section class="item-block px-md-4 px-2 py-4">
              <h4 class="item-block__title h4 mb-4">
                Криптовалюты
              </h4>
              <div class="row">
                <div class="col-12 col-md-4 col-lg-3 d-flex">
                  <div class="d-flex gap-4 flex-column p-4 shadow rounded-4 w-100">
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/btc.svg" alt="">
                        <span class="fs-24 fw-semibold">BTC</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="fs-18 fw-semibold">345 281,95 BYN</span>
                        <span class="fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/eth.svg" alt="">
                        <span class="fs-24 fw-semibold">ETH</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="fs-18 fw-semibold">96,9670 BYN</span>
                        <span class="fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/xrp.svg" alt="">
                        <span class="fs-24 fw-semibold">XRP</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="fs-18 fw-semibold">8,5001 BYN</span>
                        <span class="fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-8 col-lg-9 d-flex mt-4 mt-lg-0">
                  <div class="p-4 shadow rounded-4 w-100">
                    <div class="d-flex gap-4">
                      <div>
                        <p class="fs-14 fw-semibold mb-2">Токен</p>
                        <div class="dropdown dropdown-search-token">
                          <button class="dropdown-toggle dropdown-btn chart-token" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            BTC
                          </button>
                          <ul class="dropdown-menu dropdown-content">
                            <li class="dropdown-search">
                              <input class="dropdown-search-input" type="text">
                              <i class="dropdown-search-icon bi bi-search"></i>
                            </li>
                            <li><a class="dropdown-item chart-token-item" href="#">BTC</a></li>
                            <li><a class="dropdown-item chart-token-item" href="#">XRP</a></li>
                            <li><a class="dropdown-item chart-token-item" href="#">USDT</a></li>
                          </ul>
                        </div>
                      </div>
                      <div>
                        <p class="fs-14 fw-semibold mb-2">Месяц</p>
                        <div class="dropdown">
                          <button class="dropdown-toggle dropdown-btn chart-month" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Август
                          </button>
                          <ul class="dropdown-menu dropdown-content">
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="01">Январь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="02">Февраль</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="03">Март</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="04">Апрель</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="05">Май</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="06">Июнь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="07">Июль</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="08">Август</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="09">Сентябрь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="10">Октябрь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="11">Ноябрь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="12">Декабрь</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div class="chart-container w-100 position-relative overflow-hidden mt-4 h-100">
                      <div class="chart" style="position: absolute; width: 100%; height: 100%;">
                      </div>
                    </div>
                    <div class="d-none mt-5 justify-content-center" id="dataNotFound">
                      <div class="d-flex flex-col gap-3  align-items-center border-10 border p-4">
                        <i class="bi bi-exclamation-circle color-green fs-24"></i>
                        <span>Данные не найдены</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


              <h4 class="fs-20 fw-semibold border-bottom pb-2 mt-64">
                Архив курсов криптовалют в BYN
              </h4>

              <div class="row">
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Токен</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-token" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        BTC
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li class="dropdown-search">
                          <input class="dropdown-search-input" type="text">
                          <i class="dropdown-search-icon bi bi-search"></i>
                        </li>
                        <li><a class="dropdown-item table-token-item" href="#">BTC</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">XRP</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">USDT</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Год</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-year" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        2025
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-year-item" href="#">2025</a></li>
                        <li><a class="dropdown-item table-year-item" href="#">2018</a></li>
                        <li><a class="dropdown-item table-year-item" href="#">2024</a></li>
                        <li><a class="dropdown-item table-year-item" href="#">2023</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">Месяц</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large  table-month" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-month-item" href="#" data-value="01">Январь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="02">Февраль</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="03">Март</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="04">Апрель</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="05">Май</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="06">Июнь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="07">Июль</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="08">Август</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="09">Сентябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="10">Октябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="11">Ноябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="12">Декабрь</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fs-14 fw-semibold mb-2">День</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-day" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        1
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-day-item" href="#">1</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">2</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">3</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">4</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">5</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">6</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">7</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">8</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">9</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">10</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">11</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">12</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <!-- <div class="d-flex gap-3 flex-wrap mt-4">
                <button class="button mobile-w-100">Применить</button>
                <button class="button button-empty mobile-w-100">Сбросить</button>
              </div> -->

              <!-- <div class="table-crypto-container">
                <table class="table-crypto">
                  <thead>
                    <tr>
                      <td>Токен</td>
                      <td>01.08.2018</td>
                      <td>02.08.2018</td>
                      <td>03.08.2018</td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/btc.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/eth.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/xrp.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex align-items-center gap-2">
                          <img class="token-card-logo__small" src="./img/crypto/icons/usdt.svg" alt="">
                          <span>BTC</span>
                        </div>
                      </td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                      <td>1093,7443</td>
                    </tr>
                  </tbody>
                </table>
              </div> -->
              <div class="table-crypto-container">
                <div class="table-crypto-wrapper">
                  <!-- Верхний скролл для шапки -->
                  <div class="table-crypto-header-scroll">
                    <table class="table-crypto">
                      <thead>
                        <!-- Шапка будет сгенерирована JavaScript -->
                      </thead>
                    </table>
                  </div>

                  <!-- Основной скролл для тела -->
                  <div class="table-crypto-body-scroll">
                    <table class="table-crypto">
                      <tbody>
                        <!-- Тело будет сгенерировано JavaScript -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </main>
    @@include('_footer.html',{})
  </div>
  <script type="text/javascript" src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <!-- @@include('_popup.html',{}) -->

  @@include('_js.html',{})
  <!-- <script>
    const chartOptions = { layout: { textColor: 'black', background: { type: 'solid', color: 'white' } }, attributionLogo: false };
    const chart = LightweightCharts.createChart(document.querySelector('.chart'), chartOptions);
    const areaSeries = chart.addSeries(LightweightCharts.AreaSeries, { lineColor: '#014A37', topColor: '#007A65', bottomColor: 'rgba(0,122,101, 0.28)' });

    const data = [{
      "BTC":
        [{ time: '2018-12-22', value: 32.51 },
        { time: '2018-12-23', value: 31.11 },
        { time: '2018-12-24', value: 27.02 },
        { time: '2018-12-25', value: 27.32 },
        { time: '2018-12-26', value: 25.17 },
        { time: '2018-12-27', value: 28.89 },
        { time: '2018-12-28', value: 25.46 },
        { time: '2018-12-29', value: 23.92 },
        { time: '2018-12-30', value: 22.68 },
        { time: '2018-12-31', value: 22.67 },],
      "XRP":
        [{ time: '2018-10-22', value: 213.51 },
        { time: '2018-10-23', value: 131.11 },
        { time: '2018-10-24', value: 127.02 },
        { time: '2018-10-25', value: 127.32 },
        { time: '2018-10-26', value: 125.17 },
        { time: '2018-10-27', value: 128.89 },
        { time: '2018-10-28', value: 122.68 },
        { time: '2018-10-31', value: 22.67 },],
      "USDT":
        [{ time: '2018-05-22', value: 2199.51 },
        { time: '2018-05-23', value: 1399.11 },
        { time: '2018-05-24', value: 1299.02 },
        { time: '2018-05-25', value: 1299.32 },
        { time: '2018-05-26', value: 1299.17 },
        { time: '2018-05-27', value: 1299.89 },
        { time: '2018-05-28', value: 1299.68 },
        { time: '2018-05-31', value: 299.67 },],
    }
    ];

    areaSeries.setData(data);

    chart.timeScale().fitContent();
  </script> -->
  <script>
    // Данные для графика
    const data = {
      "BTC": [
        { time: '2018-12-22', value: 32.51 },
        { time: '2018-12-23', value: 31.11 },
        { time: '2018-12-24', value: 27.02 },
        { time: '2018-12-25', value: 27.32 },
        { time: '2025-01-01', value: 32.51 },
        { time: '2025-01-02', value: 31.11 },
        { time: '2025-01-03', value: 27.02 },
        { time: '2025-01-04', value: 27.32 },
        { time: '2018-12-26', value: 25.17 },
        { time: '2018-12-27', value: 28.89 },
        { time: '2018-12-28', value: 25.46 },
        { time: '2018-12-29', value: 23.92 },
        { time: '2018-12-30', value: 22.68 },
        { time: '2018-12-31', value: 22.67 },
        { time: '2018-11-23', value: 1231.11 },
        { time: '2018-11-24', value: 2227.02 },
        { time: '2018-11-25', value: 1227.32 },
        { time: '2018-11-26', value: 1225.17 },
        { time: '2018-11-27', value: 1228.89 },
        { time: '2018-11-28', value: 1225.46 },
        { time: '2018-11-29', value: 1223.92 },
        { time: '2018-11-30', value: 1222.68 },
        { time: '2018-01-31', value: 22.67 },
        { time: '2018-01-23', value: 31.11 },
        { time: '2018-01-24', value: 27.02 },
        { time: '2018-01-25', value: 27.32 },
        { time: '2018-01-26', value: 25.17 },
        { time: '2018-01-27', value: 28.89 },
        { time: '2018-01-28', value: 25.46 },
        { time: '2018-01-29', value: 23.92 },
        { time: '2018-01-30', value: 22.68 },
        { time: '2018-01-31', value: 22.67 }
      ],
      "XRP": [
        { time: '2018-10-22', value: 213.51 },
        { time: '2018-10-23', value: 131.11 },
        { time: '2018-10-24', value: 127.02 },
        { time: '2018-10-25', value: 127.32 },
        { time: '2018-10-26', value: 125.17 },
        { time: '2018-10-27', value: 128.89 },
        { time: '2018-10-28', value: 122.68 },
        { time: '2018-10-31', value: 22.67 }
      ],
      "USDT": [
        { time: '2018-05-22', value: 1234.51 },
        { time: '2018-05-23', value: 765.11 },
        { time: '2018-05-24', value: 1299.02 },
        { time: '2018-05-25', value: 888.32 },
        { time: '2018-05-26', value: 999.17 },
        { time: '2018-05-27', value: 345.89 },
        { time: '2018-05-28', value: 554.68 },
        { time: '2018-05-31', value: 299.67 }
      ]
    };

    // const chartOptions = {
    //   layout: {
    //     textColor: 'black',
    //     background: { type: 'solid', color: 'white' }
    //   },
    //   attributionLogo: false
    // };

    // const chart = LightweightCharts.createChart(document.querySelector('.chart'), chartOptions);
    // const areaSeries = chart.addSeries(LightweightCharts.AreaSeries, {
    //   lineColor: '#014A37',
    //   topColor: '#007A65',
    //   bottomColor: 'rgba(0,122,101, 0.28)'
    // });

    // let currentToken = 'BTC';
    // areaSeries.setData(data[currentToken]);
    // chart.timeScale().fitContent();

    // document.addEventListener('DOMContentLoaded', function () {
    //   const selectTokenBtn = document.querySelector('.chart-token')
    //   const selectMonthBtn = document.querySelector('.chart-month')

    //   const tokenItems = document.querySelectorAll('.chart-token-item');
    //   const monthItems = document.querySelectorAll('.chart-month-item');

    //   let selectedToken
    //   // Обработчик выбора токена
    //   tokenItems.forEach(item => {
    //     item.addEventListener('click', function (e) {
    //       e.preventDefault();
    //       selectedToken = this.textContent.trim();

    //       // Обновляем текст кнопки
    //       selectTokenBtn.textContent = selectedToken;

    //       // Обновляем график
    //       if (data[selectedToken] && selectedToken !== currentToken) {
    //         areaSeries.setData(data[selectedToken]);
    //         chart.timeScale().fitContent();
    //         currentToken = selectedToken;
    //       }
    //     });
    //   });

    //   monthItems.forEach(item => {
    //     item.addEventListener('click', function (e) {
    //       e.preventDefault();
    //       const selectedMonth = this.dataset.value;
    //       const selectedMonthName = this.textContent.trim();

    //       selectMonthBtn.textContent = selectedMonthName;

    //       // Обновляем график
    //       if (data[selectedToken] && selectedToken !== currentToken) {
    //         areaSeries.setData(data[selectedToken]);
    //         chart.timeScale().fitContent();
    //         currentToken = selectedToken;
    //       }
    //     });
    //   });
    // });
    document.addEventListener('DOMContentLoaded', function () {
      const selectTokenBtn = document.querySelector('.chart-token');
      const selectMonthBtn = document.querySelector('.chart-month');

      const tokenItems = document.querySelectorAll('.chart-token-item');
      const monthItems = document.querySelectorAll('.chart-month-item');
      const searchInput = document.querySelector('.dropdown-search-input');

      let selectedToken = 'BTC'; // По умолчанию
      let selectedMonth = '08'; // По умолчанию август
      let currentToken = 'BTC';
      const currentYear = new Date().getFullYear().toString(); // Текущий год

      // Инициализация графика
      const chartOptions = {
        layout: {
          textColor: 'black',
          background: { type: 'solid', color: 'white' }
        },
        attributionLogo: false
      };

      const chart = LightweightCharts.createChart(document.querySelector('.chart'), chartOptions);
      const areaSeries = chart.addSeries(LightweightCharts.AreaSeries, {
        lineColor: '#014A37',
        topColor: '#007A65',
        bottomColor: 'rgba(0,122,101, 0.28)'
      });

      // Функция для фильтрации данных по месяцу и году
      function filterDataByMonthAndYear(tokenData, month, year) {
        return tokenData.filter(item => {
          // Извлекаем год и месяц из даты (формат '2018-12-22')
          const [itemYear, itemMonth] = item.time.split('-');

          return itemMonth === month && itemYear === year;
        });
      }

      function updateChart() {
        if (data[selectedToken]) {
          const filteredData = filterDataByMonthAndYear(data[selectedToken], selectedMonth, currentYear);
          console.log("data", filteredData);
          const dataNotFound = document.querySelector('#dataNotFound')
          const chartContainer = document.querySelector('.chart-container')

          if (filteredData.length === 0) {
            chartContainer.classList.add("d-none")
            dataNotFound.classList.remove('d-none')
            dataNotFound.classList.add('d-flex')
            return
          }

          chartContainer.classList.remove("d-none")
          dataNotFound.classList.add('d-none')
          dataNotFound.classList.remove('d-flex')
          areaSeries.setData(filteredData);
          chart.timeScale().fitContent();
          currentToken = selectedToken;
        }
      }

      // Функция поиска по валютам
      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();

        tokenItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      // Обработчик выбора токена
      tokenItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          selectedToken = this.textContent.trim();

          // Обновляем текст кнопки
          selectTokenBtn.textContent = selectedToken;

          // Обновляем график
          updateChart();
        });
      });

      // Обработчик выбора месяца
      monthItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          selectedMonth = this.dataset.value;
          const selectedMonthName = this.textContent.trim();

          selectMonthBtn.textContent = selectedMonthName;

          // Обновляем график
          updateChart();
        });
      });

      // Обработчик поиска
      searchInput.addEventListener('input', performSearch);

      // Сброс поиска при закрытии дропдауна
      const tokenDropdown = document.querySelector('.dropdown');
      tokenDropdown.addEventListener('hidden.bs.dropdown', function () {
        searchInput.value = '';
        tokenItems.forEach(item => {
          item.style.display = 'block';
        });
      });

      // Первоначальная загрузка графика
      updateChart();
    });

    document.addEventListener('DOMContentLoaded', function () {
      const tableTokenBtn = document.querySelector('.table-token');
      const tableYearBtn = document.querySelector('.table-year');
      const tableMonthBtn = document.querySelector('.table-month');
      const tableDayBtn = document.querySelector('.table-day');
      const tableDayDropdown = tableDayBtn.closest('.dropdown');

      const tableTokenItems = document.querySelectorAll('.table-token-item');
      const tableYearItems = document.querySelectorAll('.table-year-item');
      const tableMonthContainer = document.querySelector('.table-month').closest('.dropdown').querySelector('.dropdown-menu');
      const tableDayContainer = document.querySelector('.table-day').closest('.dropdown').querySelector('.dropdown-menu');
      const tableTokenContainer = document.querySelector('.table-token').closest('.dropdown').querySelector('.dropdown-menu');

      const searchInput = document.querySelector('.table-token').closest('.dropdown').querySelector('.dropdown-search-input');

      let selectedToken = 'ALL';
      let selectedYear = '2025';
      let selectedMonth = 'ALL';
      let selectedDay = 'ALL';

      // Функция для обновления состояния дней
      function updateDayState() {
        if (selectedMonth === 'ALL') {
          // Если выбраны все месяцы - дизейблим дни и ставим "Все"
          tableDayBtn.disabled = true;
          tableDayDropdown.classList.add('disabled');
          selectedDay = 'ALL';
          tableDayBtn.textContent = 'Все';
        } else {
          // Если выбран конкретный месяц - включаем дни
          tableDayBtn.disabled = false;
          tableDayDropdown.classList.remove('disabled');
        }
      }

      // Функция для получения дней в месяце
      function getDaysInMonth(month, year) {
        return new Date(year, month, 0).getDate();
      }

      // Функция для обновления списка дней
      function updateDaysList() {
        if (selectedMonth === 'ALL') return; // Не обновляем если выбраны все месяцы

        const daysInMonth = getDaysInMonth(selectedMonth, selectedYear);

        // Очищаем контейнер дней
        tableDayContainer.innerHTML = '';

        // Добавляем пункт "Все"
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-day-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableDayContainer.appendChild(allLi);

        // Добавляем дни
        for (let day = 1; day <= daysInMonth; day++) {
          const li = document.createElement('li');
          const a = document.createElement('a');
          a.className = 'dropdown-item table-day-item';
          a.href = '#';
          a.textContent = day;
          a.setAttribute('data-value', day.toString());
          li.appendChild(a);
          tableDayContainer.appendChild(li);
        }

        // Обновляем обработчики событий для новых элементов
        initDayEvents();
      }

      // Функция для получения всех дат по фильтрам
      function getFilteredDates() {
        const dates = [];

        if (selectedMonth === 'ALL') {
          // Все месяцы года - показываем все дни всех месяцев
          const months = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];
          months.forEach(month => {
            const daysInMonth = getDaysInMonth(month, selectedYear);
            for (let day = 1; day <= daysInMonth; day++) {
              const dayStr = day.toString().padStart(2, '0');
              dates.push(`${selectedYear}-${month}-${dayStr}`);
            }
          });
        } else if (selectedDay === 'ALL') {
          // Все дни месяца
          const daysInMonth = getDaysInMonth(selectedMonth, selectedYear);
          for (let day = 1; day <= daysInMonth; day++) {
            const dayStr = day.toString().padStart(2, '0');
            dates.push(`${selectedYear}-${selectedMonth}-${dayStr}`);
          }
        } else {
          // Конкретный день
          const dayStr = selectedDay.padStart(2, '0');
          dates.push(`${selectedYear}-${selectedMonth}-${dayStr}`);
        }

        return dates;
      }

      // Функция для поиска значения по токену и дате
      function findValue(token, date) {
        const tokenData = data[token];
        if (!tokenData) return '';

        const found = tokenData.find(item => item.time === date);
        return found ? found.value.toString().replace('.', ',') : '';
      }

      // Функция для преобразования даты в формат DD.MM.YYYY
      function formatDate(dateString) {
        const [year, month, day] = dateString.split('-');
        return `${day}.${month}.${year}`;
      }

      // Функция для получения пути к иконке токена
      function getTokenIcon(token) {
        const icons = {
          'BTC': './img/crypto/icons/btc.svg',
          'XRP': './img/crypto/icons/xrp.svg',
          'USDT': './img/crypto/icons/usdt.svg',
          'ETH': './img/crypto/icons/eth.svg',
          'SOL': './img/crypto/icons/sol.svg',
          'SHIB': './img/crypto/icons/shib.svg'
        };
        return icons[token] || './img/crypto/icons/default.svg';
      }

      // Функция обновления таблицы
      // function updateTable() {
      //   const table = document.querySelector('.table-crypto');

      //   // Очищаем таблицу
      //   table.innerHTML = '';

      //   const tokens = selectedToken === 'ALL' ? Object.keys(data) : [selectedToken];
      //   const dates = getFilteredDates();

      //   // Создаем шапку таблицы
      //   const thead = document.createElement('thead');
      //   const headerRow = document.createElement('tr');

      //   // Первая ячейка "Токен"
      //   const tokenHeader = document.createElement('td');
      //   tokenHeader.textContent = 'Токен';
      //   headerRow.appendChild(tokenHeader);

      //   // Добавляем даты в шапку
      //   dates.forEach(date => {
      //     const dateHeader = document.createElement('td');
      //     dateHeader.textContent = formatDate(date);
      //     headerRow.appendChild(dateHeader);
      //   });

      //   thead.appendChild(headerRow);
      //   table.appendChild(thead);

      //   // Создаем тело таблицы
      //   const tbody = document.createElement('tbody');

      //   // Добавляем строки для каждого токена
      //   tokens.forEach(token => {
      //     const row = document.createElement('tr');

      //     // Ячейка с токеном и иконкой
      //     const tokenCell = document.createElement('td');
      //     tokenCell.innerHTML = `
      //   <div class="d-flex align-items-center gap-2">
      //     <img class="token-card-logo__small" src="${getTokenIcon(token)}" alt="${token}">
      //     <span>${token}</span>
      //   </div>
      // `;
      //     row.appendChild(tokenCell);

      //     // Ячейки со значениями для каждой даты
      //     dates.forEach(date => {
      //       const valueCell = document.createElement('td');
      //       valueCell.textContent = findValue(token, date);
      //       row.appendChild(valueCell);
      //     });

      //     tbody.appendChild(row);
      //   });

      //   table.appendChild(tbody);
      // }

      function updateTable() {
        const tableHeader = document.querySelector('.table-crypto-header-scroll .table-crypto');
        const tableBody = document.querySelector('.table-crypto-body-scroll .table-crypto');

        // Очищаем таблицы
        tableHeader.innerHTML = '';
        tableBody.innerHTML = '';

        const tokens = selectedToken === 'ALL' ? Object.keys(data) : [selectedToken];
        const dates = getFilteredDates();

        // Создаем шапку таблицы (для верхнего скролла)
        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');

        // Первая ячейка "Токен"
        const tokenHeader = document.createElement('td');
        tokenHeader.textContent = 'Токен';
        headerRow.appendChild(tokenHeader);

        // Добавляем даты в шапку
        dates.forEach(date => {
          const dateHeader = document.createElement('td');
          dateHeader.textContent = formatDate(date);
          headerRow.appendChild(dateHeader);
        });

        thead.appendChild(headerRow);
        tableHeader.appendChild(thead);

        // Создаем тело таблицы (для основного скролла)
        const tbody = document.createElement('tbody');

        // Добавляем строки для каждого токена
        tokens.forEach(token => {
          const row = document.createElement('tr');

          // Ячейка с токеном и иконкой
          const tokenCell = document.createElement('td');
          tokenCell.innerHTML = `
      <div class="d-flex align-items-center gap-2">
        <img class="token-card-logo__small" src="${getTokenIcon(token)}" alt="${token}">
        <span>${token}</span>
      </div>
    `;
          row.appendChild(tokenCell);

          // Ячейки со значениями для каждой даты
          dates.forEach(date => {
            const valueCell = document.createElement('td');
            valueCell.textContent = findValue(token, date);
            row.appendChild(valueCell);
          });

          tbody.appendChild(row);
        });

        tableBody.appendChild(tbody);

        // Синхронизация скроллов
        syncScrolls();
      }

      // Функция синхронизации горизонтальных скроллов
      function syncScrolls() {
        const headerScroll = document.querySelector('.table-crypto-header-scroll');
        const bodyScroll = document.querySelector('.table-crypto-body-scroll');

        headerScroll.addEventListener('scroll', function () {
          bodyScroll.scrollLeft = this.scrollLeft;
        });

        bodyScroll.addEventListener('scroll', function () {
          headerScroll.scrollLeft = this.scrollLeft;
        });
      }

      // Вызываем синхронизацию при загрузке
      document.addEventListener('DOMContentLoaded', function () {
        syncScrolls();
      });

      // Функция поиска по токенам
      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();

        const allTokenItems = document.querySelectorAll('.table-token-item');
        allTokenItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text === 'все' || text.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      // Инициализация обработчиков дней
      function initDayEvents() {
        const tableDayItems = document.querySelectorAll('.table-day-item');

        tableDayItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedDay = value;
            tableDayBtn.textContent = this.textContent.trim();
            updateTable();
          });
        });
      }

      // Инициализация обработчиков токенов
      function initTokenEvents() {
        const allTokenItems = document.querySelectorAll('.table-token-item');

        allTokenItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedToken = value;
            tableTokenBtn.textContent = this.textContent.trim();
            updateTable();
          });
        });
      }

      // Инициализация обработчиков месяцев
      function initMonthEvents() {
        const tableMonthItems = document.querySelectorAll('.table-month-item');

        tableMonthItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedMonth = value;
            tableMonthBtn.textContent = this.textContent.trim();
            updateDayState(); // Обновляем состояние дней
            updateDaysList(); // Обновляем список дней
            updateTable();
          });
        });
      }

      // Обработчики годов
      tableYearItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          selectedYear = this.textContent.trim();
          tableYearBtn.textContent = selectedYear;
          updateDayState(); // Обновляем состояние дней
          updateDaysList(); // Обновляем список дней
          updateTable();
        });
      });

      // Добавляем пункт "Все" в токены
      function addAllTokenOption() {
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-token-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableTokenContainer.insertBefore(allLi, tableTokenContainer.querySelector('.dropdown-search').nextSibling);
      }

      // Добавляем пункт "Все" в месяцы
      function addAllMonthOption() {
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-month-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableMonthContainer.insertBefore(allLi, tableMonthContainer.firstChild);
      }

      // Обработчик поиска
      searchInput.addEventListener('input', performSearch);

      // Сброс поиска при закрытии дропдауна
      const tokenDropdown = tableTokenBtn.closest('.dropdown');
      tokenDropdown.addEventListener('hidden.bs.dropdown', function () {
        searchInput.value = '';
        const allTokenItems = document.querySelectorAll('.table-token-item');
        allTokenItems.forEach(item => {
          item.style.display = 'block';
        });
      });

      // Инициализация
      addAllTokenOption(); // Добавляем "Все" в токены
      addAllMonthOption(); // Добавляем "Все" в месяцы
      updateDayState(); // Первоначальное обновление состояния дней
      updateDaysList(); // Первоначальная генерация дней
      initTokenEvents(); // Инициализация обработчиков токенов
      initMonthEvents(); // Инициализация обработчиков месяцев
      initDayEvents(); // Инициализация обработчиков дней

      // Устанавливаем начальные значения
      tableTokenBtn.textContent = 'Все';
      tableMonthBtn.textContent = 'Все';
      tableDayBtn.textContent = 'Все';

      updateTable(); // Первоначальное построение таблицы
    });
  </script>


</body>

</html>