<!DOCTYPE html>
<html lang="ru">
@@include('_head.html',{
"title":"Криптовалюты"
})

<body>
  <div class="wrapper">
    @@include('_header.html',{})
    <main class="page page__decor">
      <div class="content px-2">
        <nav aria-label="breadcrumb">
          <div class='container'>
            <ol class="breadcrumb">
              <li class="breadcrumb-item mr-3">
                <a href="index.html">
                  Главная<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item mr-3">
                <a href="services.html">
                  Сервисы<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item mr-3">
                <a href="services.html">
                  Курсы цифровых знаков (токенов)<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item active" aria-current="page">Криптовалюты</li>
            </ol>
          </div>
        </nav>
        <div class="item-content">
          <div class="container">
            <section class="item-block px-md-4 px-2 py-4">
              <h4 class="item-block__title h4 mb-4">
                Криптовалюты
              </h4>
              <div class="row">
                <div class="col-12 col-md-4 col-lg-3 d-flex">
                  <div class="d-flex gap-4 flex-column p-4 shadow rounded-4 w-100">
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/btc.svg" alt="">
                        <span class="fs-24 fw-semibold">BTC</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="token-card-value fs-18 fw-semibold">345 281,95 BYN</span>
                        <span class="token-card-date fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/eth.svg" alt="">
                        <span class="fs-24 fw-semibold">ETH</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="token-card-value fs-18 fw-semibold">96,9670 BYN</span>
                        <span class="token-card-date fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                    <div class="bg-color-gray-light border-10 p-3">
                      <div class="token-card-header d-flex gap-2">
                        <img class="token-card-logo" src="./img/crypto/icons/xrp.svg" alt="">
                        <span class="fs-24 fw-semibold">XRP</span>
                      </div>
                      <div class="token-card-content d-flex justify-content-between gap-3 align-items-center">
                        <span class="token-card-value fs-18 fw-semibold">8,5001 BYN</span>
                        <span class="token-card-date fs-14 color-gray-dark">на 31.08.2025</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-8 col-lg-9 d-flex mt-4 mt-lg-0">
                  <div class="p-4 shadow rounded-4 w-100">
                    <div class="d-flex gap-4">
                      <div>
                        <p class="fw-semibold mb-2">Токен</p>
                        <div class="dropdown dropdown-search-token">
                          <button class="dropdown-toggle dropdown-btn chart-token" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            BTC
                          </button>
                          <ul class="dropdown-menu dropdown-content">
                            <li class="dropdown-search">
                              <input class="dropdown-search-input" type="text">
                              <i class="dropdown-search-icon bi bi-search"></i>
                            </li>
                            <li><a class="dropdown-item chart-token-item" href="#">BTC</a></li>
                            <li><a class="dropdown-item chart-token-item" href="#">XRP</a></li>
                            <li><a class="dropdown-item chart-token-item" href="#">USDT</a></li>
                          </ul>
                        </div>
                      </div>
                      <div>
                        <p class="fw-semibold mb-2">Месяц</p>
                        <div class="dropdown">
                          <button class="dropdown-toggle dropdown-btn chart-month" type="button" data-bs-toggle="dropdown" aria-expanded="false">

                          </button>
                          <ul class="dropdown-menu dropdown-content">
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="01">Январь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="02">Февраль</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="03">Март</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="04">Апрель</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="05">Май</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="06">Июнь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="07">Июль</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="08">Август</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="09">Сентябрь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="10">Октябрь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="11">Ноябрь</a></li>
                            <li><a class="dropdown-item chart-month-item" href="#" data-value="12">Декабрь</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                    <div class="chart-container w-100 position-relative overflow-hidden mt-4 h-100">
                      <div class="chart" style="position: absolute; width: 100%; height: 100%;">
                      </div>
                    </div>
                    <div class="d-none mt-5 justify-content-center" id="dataNotFound">
                      <div class="d-flex flex-col gap-3  align-items-center border-10 border p-4">
                        <i class="bi bi-exclamation-circle color-green fs-24"></i>
                        <span>Данные не найдены</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


              <h4 class="fs-20 fw-semibold border-bottom pb-2 mt-64">
                Архив курсов криптовалют в BYN
              </h4>

              <div class="row">
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">Токен</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-token" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        BTC
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li class="dropdown-search">
                          <input class="dropdown-search-input" type="text">
                          <i class="dropdown-search-icon bi bi-search"></i>
                        </li>
                        <li><a class="dropdown-item table-token-item" href="#">BTC</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">XRP</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">USDT</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">Год</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-year" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        2025
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-year-item" href="#">2025</a></li>
                        <li><a class="dropdown-item table-year-item" href="#">2024</a></li>
                        <li><a class="dropdown-item table-year-item" href="#">2023</a></li>
                        <li><a class="dropdown-item table-year-item" href="#">2018</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">Месяц</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large  table-month" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-month-item" href="#" data-value="01">Январь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="02">Февраль</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="03">Март</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="04">Апрель</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="05">Май</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="06">Июнь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="07">Июль</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="08">Август</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="09">Сентябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="10">Октябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="11">Ноябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="12">Декабрь</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">День</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-day" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        1
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-day-item" href="#">1</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">2</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">3</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">4</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">5</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">6</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">7</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">8</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">9</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">10</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">11</a></li>
                        <li><a class="dropdown-item table-day-item" href="#">12</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <div class="table-crypto-container">
                <div class="table-crypto-wrapper">

                  <div class="table-crypto-header-scroll">
                    <table class="table-crypto">
                      <thead>

                      </thead>
                    </table>
                  </div>


                  <div class="table-crypto-body-scroll">
                    <table class="table-crypto">
                      <tbody>

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </main>
    @@include('_footer.html',{})
  </div>
  <script type="text/javascript" src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <!-- @@include('_popup.html',{}) -->

  @@include('_js.html',{})

  <script>
    const data = {
      "BTC": [
        { time: '2018-12-22', value: 32.51 },
        { time: '2018-12-23', value: 31.11 },
        { time: '2018-12-24', value: 27.02 },
        { time: '2018-12-25', value: 27.32 },
        { time: '2025-01-01', value: 32.51 },
        { time: '2025-01-02', value: 31.11 },
        { time: '2025-01-03', value: 27.02 },
        { time: '2025-01-04', value: 27.32 },
        { time: '2018-12-26', value: 25.17 },
        { time: '2018-12-27', value: 28.89 },
        { time: '2018-12-28', value: 25.46 },
        { time: '2018-12-29', value: 23.92 },
        { time: '2018-12-30', value: 22.68 },
        { time: '2018-12-31', value: 22.67 },
        { time: '2018-11-23', value: 1231.11 },
        { time: '2018-11-24', value: 2227.02 },
        { time: '2018-11-25', value: 1227.32 },
        { time: '2018-11-26', value: 1225.17 },
        { time: '2018-11-27', value: 1228.89 },
        { time: '2018-11-28', value: 1225.46 },
        { time: '2018-11-29', value: 1223.92 },
        { time: '2018-11-30', value: 1222.68 },
        { time: '2018-01-31', value: 22.67 },
        { time: '2018-01-23', value: 31.11 },
        { time: '2018-01-24', value: 27.02 },
        { time: '2018-01-25', value: 27.32 },
        { time: '2018-01-26', value: 25.17 },
        { time: '2018-01-27', value: 28.89 },
        { time: '2018-01-28', value: 25.46 },
        { time: '2018-01-29', value: 23.92 },
        { time: '2018-01-30', value: 22.68 },
        { time: '2018-01-31', value: 22.67 }
      ],
      "XRP": [
        { time: '2018-10-22', value: 213.51 },
        { time: '2018-10-23', value: 131.11 },
        { time: '2018-10-24', value: 127.02 },
        { time: '2018-10-25', value: 127.32 },
        { time: '2018-10-26', value: 125.17 },
        { time: '2018-10-27', value: 128.89 },
        { time: '2018-10-28', value: 122.68 },
        { time: '2018-10-31', value: 22.67 },
        { time: '2025-10-22', value: 213.51 },
        { time: '2025-10-23', value: 131.11 },
        { time: '2025-10-24', value: 127.02 },
        { time: '2025-10-25', value: 127.32 },
        { time: '2025-10-26', value: 125.17 },
        { time: '2025-10-27', value: 128.89 },
        { time: '2025-10-28', value: 122.68 },
        { time: '2025-10-31', value: 22.67 }
      ],
      "USDT": [
        { time: '2018-05-22', value: 1234.51 },
        { time: '2018-05-23', value: 765.11 },
        { time: '2018-05-24', value: 1299.02 },
        { time: '2018-05-25', value: 888.32 },
        { time: '2018-05-26', value: 999.17 },
        { time: '2018-05-27', value: 345.89 },
        { time: '2018-05-28', value: 554.68 },
        { time: '2018-05-31', value: 299.67 }
      ]
    };


    document.addEventListener('DOMContentLoaded', function () {
      const selectTokenBtn = document.querySelector('.chart-token');
      const selectMonthBtn = document.querySelector('.chart-month');

      const tokenItems = document.querySelectorAll('.chart-token-item');
      const monthItems = document.querySelectorAll('.chart-month-item');
      const searchInput = document.querySelector('.dropdown-search-input');

      const currentYear = new Date().getFullYear().toString();
      const currentMonth = (new Date().getMonth() + 1).toString().padStart(2, '0');

      let selectedToken = 'BTC';
      let selectedMonth = currentMonth;
      let currentToken = 'BTC';

      const chartOptions = {
        layout: {
          textColor: 'black',
          background: { type: 'solid', color: 'white' }
        },
        attributionLogo: false
      };

      const chart = LightweightCharts.createChart(document.querySelector('.chart'), chartOptions);
      const areaSeries = chart.addSeries(LightweightCharts.AreaSeries, {
        lineColor: '#007A65',
        topColor: 'rgba(0,122,101, 0.40)',
        bottomColor: 'rgba(0,122,101, 0.01)'
      });

      function filterDataByMonthAndYear(tokenData, month, year) {
        return tokenData.filter(item => {
          const [itemYear, itemMonth] = item.time.split('-');
          return itemMonth === month && itemYear === year;
        });
      }

      function updateChart() {
        if (data[selectedToken]) {
          const filteredData = filterDataByMonthAndYear(data[selectedToken], selectedMonth, currentYear);
          const dataNotFound = document.querySelector('#dataNotFound')
          const chartContainer = document.querySelector('.chart-container')

          if (filteredData.length === 0) {
            chartContainer.classList.add("d-none")
            dataNotFound.classList.remove('d-none')
            dataNotFound.classList.add('d-flex')
            return
          }

          chartContainer.classList.remove("d-none")
          dataNotFound.classList.add('d-none')
          dataNotFound.classList.remove('d-flex')
          areaSeries.setData(filteredData);
          chart.timeScale().fitContent();
          currentToken = selectedToken;
        }
      }

      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();

        tokenItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      monthItems.forEach(item => {
        if (item.dataset.value === currentMonth) {
          selectMonthBtn.textContent = item.textContent.trim();
        }
      });

      tokenItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          selectedToken = this.textContent.trim();

          selectTokenBtn.textContent = selectedToken;

          updateChart();
        });
      });

      monthItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          selectedMonth = this.dataset.value;
          const selectedMonthName = this.textContent.trim();

          selectMonthBtn.textContent = selectedMonthName;

          updateChart();
        });
      });

      searchInput.addEventListener('input', performSearch);

      const tokenDropdown = document.querySelector('.dropdown');
      tokenDropdown.addEventListener('hidden.bs.dropdown', function () {
        searchInput.value = '';
        tokenItems.forEach(item => {
          item.style.display = 'block';
        });
      });

      function getLastAvailableDate(tokenData, year) {
        // Фильтруем данные по текущему году
        const yearData = tokenData.filter(item => {
          const [itemYear] = item.time.split('-');
          return itemYear === year;
        });

        if (yearData.length === 0) return null;

        const lastDate = yearData.reduce((max, item) => {
          return item.time > max ? item.time : max;
        }, yearData[0].time);

        return lastDate;
      }

      function updateTokenCards() {
        const tokenCards = {
          'BTC': document.querySelector('.token-card-header img[src*="btc"]').closest('.bg-color-gray-light'),
          'ETH': document.querySelector('.token-card-header img[src*="eth"]').closest('.bg-color-gray-light'),
          'XRP': document.querySelector('.token-card-header img[src*="xrp"]').closest('.bg-color-gray-light')
        };

        Object.keys(tokenCards).forEach(token => {
          if (data[token]) {
            const lastDate = getLastAvailableDate(data[token], currentYear);

            if (lastDate) {
              const lastData = data[token].find(item => item.time === lastDate);

              if (lastData) {
                const card = tokenCards[token];
                const priceElement = card.querySelector('.token-card-value');
                const dateElement = card.querySelector('.token-card-date');

                const [year, month, day] = lastDate.split('-');
                const formattedDate = `${day}.${month}.${year}`;

                priceElement.textContent = `${lastData.value.toLocaleString('ru-RU')} BYN`;
                dateElement.textContent = `на ${formattedDate}`;
              }
            }
          }
        });
      }
      updateTokenCards();
      updateChart();
    });

    document.addEventListener('DOMContentLoaded', function () {
      const tableTokenBtn = document.querySelector('.table-token');
      const tableYearBtn = document.querySelector('.table-year');
      const tableMonthBtn = document.querySelector('.table-month');
      const tableDayBtn = document.querySelector('.table-day');
      const tableDayDropdown = tableDayBtn.closest('.dropdown');

      const tableTokenItems = document.querySelectorAll('.table-token-item');
      const tableYearItems = document.querySelectorAll('.table-year-item');
      const tableMonthContainer = document.querySelector('.table-month').closest('.dropdown').querySelector('.dropdown-menu');
      const tableDayContainer = document.querySelector('.table-day').closest('.dropdown').querySelector('.dropdown-menu');
      const tableTokenContainer = document.querySelector('.table-token').closest('.dropdown').querySelector('.dropdown-menu');

      const searchInput = document.querySelector('.table-token').closest('.dropdown').querySelector('.dropdown-search-input');

      let selectedToken = 'ALL';
      let selectedYear = '2025';
      let selectedMonth = 'ALL';
      let selectedDay = 'ALL';

      function updateDayState() {
        if (selectedMonth === 'ALL') {

          tableDayBtn.disabled = true;
          tableDayDropdown.classList.add('disabled');
          selectedDay = 'ALL';
          tableDayBtn.textContent = 'Все';
        } else {

          tableDayBtn.disabled = false;
          tableDayDropdown.classList.remove('disabled');
        }
      }

      function getDaysInMonth(month, year) {
        return new Date(year, month, 0).getDate();
      }

      function updateDaysList() {
        if (selectedMonth === 'ALL') return;

        const daysInMonth = getDaysInMonth(selectedMonth, selectedYear);


        tableDayContainer.innerHTML = '';

        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-day-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableDayContainer.appendChild(allLi);

        for (let day = 1; day <= daysInMonth; day++) {
          const li = document.createElement('li');
          const a = document.createElement('a');
          a.className = 'dropdown-item table-day-item';
          a.href = '#';
          a.textContent = day;
          a.setAttribute('data-value', day.toString());
          li.appendChild(a);
          tableDayContainer.appendChild(li);
        }

        initDayEvents();
      }

      function getFilteredDates() {
        const dates = [];

        if (selectedMonth === 'ALL') {
          const months = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];
          months.forEach(month => {
            const daysInMonth = getDaysInMonth(month, selectedYear);
            for (let day = 1; day <= daysInMonth; day++) {
              const dayStr = day.toString().padStart(2, '0');
              dates.push(`${selectedYear}-${month}-${dayStr}`);
            }
          });
        } else if (selectedDay === 'ALL') {
          const daysInMonth = getDaysInMonth(selectedMonth, selectedYear);
          for (let day = 1; day <= daysInMonth; day++) {
            const dayStr = day.toString().padStart(2, '0');
            dates.push(`${selectedYear}-${selectedMonth}-${dayStr}`);
          }
        } else {
          const dayStr = selectedDay.padStart(2, '0');
          dates.push(`${selectedYear}-${selectedMonth}-${dayStr}`);
        }

        return dates;
      }

      function findValue(token, date) {
        const tokenData = data[token];
        if (!tokenData) return '';

        const found = tokenData.find(item => item.time === date);
        return found ? found.value.toString().replace('.', ',') : '';
      }

      function formatDate(dateString) {
        const [year, month, day] = dateString.split('-');
        return `${day}.${month}.${year}`;
      }

      function getTokenIcon(token) {
        const icons = {
          'BTC': './img/crypto/icons/btc.svg',
          'XRP': './img/crypto/icons/xrp.svg',
          'USDT': './img/crypto/icons/usdt.svg',
          'ETH': './img/crypto/icons/eth.svg',
          'SOL': './img/crypto/icons/sol.svg',
          'SHIB': './img/crypto/icons/shib.svg'
        };
        return icons[token] || './img/crypto/icons/default.svg';
      }

      function updateTable() {
        const tableHeader = document.querySelector('.table-crypto-header-scroll .table-crypto');
        const tableBody = document.querySelector('.table-crypto-body-scroll .table-crypto');

        tableHeader.innerHTML = '';
        tableBody.innerHTML = '';

        const tokens = selectedToken === 'ALL' ? Object.keys(data) : [selectedToken];
        const dates = getFilteredDates();

        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');

        const tokenHeader = document.createElement('td');
        tokenHeader.textContent = 'Токен';
        headerRow.appendChild(tokenHeader);

        dates.forEach(date => {
          const dateHeader = document.createElement('td');
          dateHeader.textContent = formatDate(date);
          headerRow.appendChild(dateHeader);
        });

        thead.appendChild(headerRow);
        tableHeader.appendChild(thead);

        const tbody = document.createElement('tbody');

        tokens.forEach(token => {
          const row = document.createElement('tr');

          const tokenCell = document.createElement('td');
          tokenCell.innerHTML = `
      <div class="d-flex align-items-center gap-2">
        <img class="token-card-logo__small" src="${getTokenIcon(token)}" alt="${token}">
        <span>${token}</span>
      </div>
    `;
          row.appendChild(tokenCell);

          dates.forEach(date => {
            const valueCell = document.createElement('td');
            valueCell.textContent = findValue(token, date);
            row.appendChild(valueCell);
          });

          tbody.appendChild(row);
        });

        tableBody.appendChild(tbody);

        syncScrolls();
      }

      function syncScrolls() {
        const headerScroll = document.querySelector('.table-crypto-header-scroll');
        const bodyScroll = document.querySelector('.table-crypto-body-scroll');

        headerScroll.addEventListener('scroll', function () {
          bodyScroll.scrollLeft = this.scrollLeft;
        });

        bodyScroll.addEventListener('scroll', function () {
          headerScroll.scrollLeft = this.scrollLeft;
        });
      }

      document.addEventListener('DOMContentLoaded', function () {
        syncScrolls();
      });

      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();

        const allTokenItems = document.querySelectorAll('.table-token-item');
        allTokenItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text === 'все' || text.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      function initDayEvents() {
        const tableDayItems = document.querySelectorAll('.table-day-item');

        tableDayItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedDay = value;
            tableDayBtn.textContent = this.textContent.trim();
            updateTable();
          });
        });
      }

      function initTokenEvents() {
        const allTokenItems = document.querySelectorAll('.table-token-item');

        allTokenItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedToken = value;
            tableTokenBtn.textContent = this.textContent.trim();
            updateTable();
          });
        });
      }

      function initMonthEvents() {
        const tableMonthItems = document.querySelectorAll('.table-month-item');

        tableMonthItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedMonth = value;
            tableMonthBtn.textContent = this.textContent.trim();
            updateDayState();
            updateDaysList();
            updateTable();
          });
        });
      }

      tableYearItems.forEach(item => {
        item.addEventListener('click', function (e) {
          e.preventDefault();
          selectedYear = this.textContent.trim();
          tableYearBtn.textContent = selectedYear;
          updateDayState();
          updateDaysList();
          updateTable();
        });
      });

      function addAllTokenOption() {
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-token-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableTokenContainer.insertBefore(allLi, tableTokenContainer.querySelector('.dropdown-search').nextSibling);
      }

      function addAllMonthOption() {
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-month-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableMonthContainer.insertBefore(allLi, tableMonthContainer.firstChild);
      }

      searchInput.addEventListener('input', performSearch);

      const tokenDropdown = tableTokenBtn.closest('.dropdown');
      tokenDropdown.addEventListener('hidden.bs.dropdown', function () {
        searchInput.value = '';
        const allTokenItems = document.querySelectorAll('.table-token-item');
        allTokenItems.forEach(item => {
          item.style.display = 'block';
        });
      });

      addAllTokenOption();
      addAllMonthOption();
      updateDayState();
      updateDaysList();
      initTokenEvents();
      initMonthEvents();
      initDayEvents();

      tableTokenBtn.textContent = 'Все';
      tableMonthBtn.textContent = 'Все';
      tableDayBtn.textContent = 'Все';

      updateTable();
    });
  </script>


</body>

</html>