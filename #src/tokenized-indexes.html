<!DOCTYPE html>
<html lang="ru">
@@include('_head.html',{
"title":"Токенизированные индексы"
})

<body>
  <div class="wrapper">
    @@include('_header.html',{})
    <main class="page page__decor">
      <div class="content px-2">
        <nav aria-label="breadcrumb">
          <div class='container'>
            <ol class="breadcrumb">
              <li class="breadcrumb-item mr-3">
                <a href="index.html">
                  Главная<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item mr-3">
                <a href="services.html">
                  Сервисы<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item mr-3">
                <a href="crypto-services.html">
                  Курсы цифровых знаков (токенов)<i class="bi-chevron-right ml-2"></i>
                </a>
              </li>
              <li class="breadcrumb-item active" aria-current="page">Токенизированные индексы</li>
            </ol>
          </div>
        </nav>
        <div class="item-content">
          <div class="container">
            <section class="item-block px-md-4 px-2 py-4">
              <h4 class="item-block__title h4 mb-4 d-flex justify-content-between align-items-center flex-wrap gap-3">
                <span>Токенизированные индексы</span>
                <a href="#" class="d-flex align-items-center gap-2">
                  <span class="fs-14">Перейти в архив</span>
                  <i class="bi bi-arrow-right"></i>
                </a>
              </h4>

              <div class="row">
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">Токенизированный актив</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-token" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        China A50
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li class="dropdown-search">
                          <input class="dropdown-search-input" type="text">
                          <i class="dropdown-search-icon bi bi-search"></i>
                        </li>
                        <li><a class="dropdown-item table-token-item" href="#">China A50</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">EU Stocks 50</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">France 40</a></li>
                        <li><a class="dropdown-item table-token-item" href="#">Germany 40</a></li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">Месяц</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large  table-month" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Август
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                        <li><a class="dropdown-item table-month-item" href="#" data-value="01">Январь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="02">Февраль</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="03">Март</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="04">Апрель</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="05">Май</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="06">Июнь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="07">Июль</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="08">Август</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="09">Сентябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="10">Октябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="11">Ноябрь</a></li>
                        <li><a class="dropdown-item table-month-item" href="#" data-value="12">Декабрь</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3">
                  <div class="mt-3">
                    <p class="fw-semibold mb-2">День</p>
                    <div class="dropdown">
                      <button class="dropdown-toggle dropdown-btn__large table-day" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        1
                      </button>
                      <ul class="dropdown-menu dropdown-content">
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-4 col-lg-3 d-flex justify-content-end">
                  <div class="d-flex justify-content-end align-items-end mb-3 mt-3 mt-lg-0">
                    <a href="#" class="link-download__icon">
                      <i class="bi bi-download mr-2"></i>
                      <span class="fs-14">Скачать документ</span>
                    </a>
                  </div>
                </div>
              </div>

              <div class="table-crypto-container">
                <div class="table-crypto-wrapper">

                  <div class="table-crypto-header-scroll">
                    <table class="table-crypto">
                      <thead>

                      </thead>
                    </table>
                  </div>

                  <div class="table-crypto-body-scroll">
                    <table class="table-crypto">
                      <tbody>

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </main>
    @@include('_footer.html',{})
  </div>
  <script type="text/javascript" src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <!-- @@include('_popup.html',{}) -->

  @@include('_js.html',{})

  <script>
    const data = {
      "A2A SPA": [
        { time: '2018-12-22', value: 32.51 },
        { time: '2018-12-22', value: 33.51 },
        { time: '2018-12-23', value: 31.11 },
        { time: '2018-12-24', value: 27.02 },
        { time: '2018-12-25', value: 27.32 },
        { time: '2025-01-01', value: 32.51 },
        { time: '2025-01-02', value: 31.11 },
        { time: '2025-01-03', value: 27.02 },
        { time: '2025-01-04', value: 27.32 },
        { time: '2025-03-01', value: 32.51 },
        { time: '2025-03-02', value: 31.11 },
        { time: '2025-03-03', value: 27.02 },
        { time: '2025-03-04', value: 27.32 },
        { time: '2025-07-01', value: 32.51 },
        { time: '2025-07-02', value: 31.11 },
        { time: '2025-07-03', value: 27.02 },
        { time: '2025-07-04', value: 27.32 },
        { time: '2018-12-26', value: 25.17 },
        { time: '2018-12-27', value: 28.89 },
        { time: '2018-12-28', value: 25.46 },
        { time: '2018-12-29', value: 23.92 },
        { time: '2018-12-30', value: 22.68 },
        { time: '2018-12-31', value: 22.67 },
        { time: '2018-11-23', value: 1231.11 },
        { time: '2018-11-24', value: 2227.02 },
        { time: '2018-11-25', value: 1227.32 },
        { time: '2018-11-26', value: 1225.17 },
        { time: '2018-11-27', value: 1228.89 },
        { time: '2018-11-28', value: 1225.46 },
        { time: '2018-11-29', value: 1223.92 },
        { time: '2018-11-30', value: 1222.68 },
        { time: '2018-01-31', value: 22.67 },
        { time: '2018-01-23', value: 31.11 },
        { time: '2018-01-24', value: 27.02 },
        { time: '2018-01-25', value: 27.32 },
        { time: '2018-01-26', value: 25.17 },
        { time: '2018-01-27', value: 28.89 },
        { time: '2018-01-28', value: 25.46 },
        { time: '2018-01-29', value: 23.92 },
        { time: '2018-01-30', value: 22.68 },
        { time: '2018-01-31', value: 22.67 }
      ],
      "XRP": [
        { time: '2018-10-22', value: 213.51 },
        { time: '2018-10-23', value: 131.11 },
        { time: '2018-10-24', value: 127.02 },
        { time: '2018-10-25', value: 127.32 },
        { time: '2018-10-26', value: 125.17 },
        { time: '2018-10-27', value: 128.89 },
        { time: '2018-10-28', value: 122.68 },
        { time: '2018-10-31', value: 22.67 },
        { time: '2025-10-22', value: 213.51 },
        { time: '2025-10-23', value: 131.11 },
        { time: '2025-10-24', value: 127.02 },
        { time: '2025-10-25', value: 127.32 },
        { time: '2025-10-26', value: 125.17 },
        { time: '2025-10-27', value: 128.89 },
        { time: '2025-10-28', value: 122.68 },
        { time: '2025-10-31', value: 22.67 }
      ],
      "USDT": [
        { time: '2018-05-22', value: 1234.51 },
        { time: '2018-05-23', value: 765.11 },
        { time: '2018-05-24', value: 1299.02 },
        { time: '2018-05-25', value: 888.32 },
        { time: '2018-05-26', value: 999.17 },
        { time: '2018-05-27', value: 345.89 },
        { time: '2018-05-28', value: 554.68 },
        { time: '2018-05-31', value: 299.67 }
      ]
    };

    document.addEventListener('DOMContentLoaded', function () {
      const tableTokenBtn = document.querySelector('.table-token');
      const tableMonthBtn = document.querySelector('.table-month');
      const tableDayBtn = document.querySelector('.table-day');
      const tableDayDropdown = tableDayBtn.closest('.dropdown');

      const tableTokenItems = document.querySelectorAll('.table-token-item');
      const tableMonthContainer = document.querySelector('.table-month').closest('.dropdown').querySelector('.dropdown-menu');
      const tableDayContainer = document.querySelector('.table-day').closest('.dropdown').querySelector('.dropdown-menu');
      const tableTokenContainer = document.querySelector('.table-token').closest('.dropdown').querySelector('.dropdown-menu');

      const searchInput = document.querySelector('.table-token').closest('.dropdown').querySelector('.dropdown-search-input');

      const currentYear = new Date().getFullYear().toString();

      let selectedToken = 'ALL';
      let selectedMonth = 'ALL';
      let selectedDay = 'ALL';

      function updateDayState() {
        if (selectedMonth === 'ALL') {
          tableDayBtn.disabled = true;
          tableDayDropdown.classList.add('disabled');
          selectedDay = 'ALL';
          tableDayBtn.textContent = 'Все';
        } else {
          tableDayBtn.disabled = false;
          tableDayDropdown.classList.remove('disabled');
        }
      }

      function getDaysInMonth(month, year) {
        return new Date(year, month, 0).getDate();
      }

      function updateDaysList() {
        if (selectedMonth === 'ALL') return;

        const daysInMonth = getDaysInMonth(selectedMonth, currentYear);

        tableDayContainer.innerHTML = '';

        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-day-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableDayContainer.appendChild(allLi);

        for (let day = 1; day <= daysInMonth; day++) {
          const li = document.createElement('li');
          const a = document.createElement('a');
          a.className = 'dropdown-item table-day-item';
          a.href = '#';
          a.textContent = day;
          a.setAttribute('data-value', day.toString());
          li.appendChild(a);
          tableDayContainer.appendChild(li);
        }

        initDayEvents();
      }

      function getFilteredDates() {
        const dates = [];

        if (selectedMonth === 'ALL') {
          const months = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];
          months.forEach(month => {
            const daysInMonth = getDaysInMonth(month, currentYear);
            for (let day = 1; day <= daysInMonth; day++) {
              const dayStr = day.toString().padStart(2, '0');
              dates.push(`${currentYear}-${month}-${dayStr}`);
            }
          });
        } else if (selectedDay === 'ALL') {
          const daysInMonth = getDaysInMonth(selectedMonth, currentYear);
          for (let day = 1; day <= daysInMonth; day++) {
            const dayStr = day.toString().padStart(2, '0');
            dates.push(`${currentYear}-${selectedMonth}-${dayStr}`);
          }
        } else {
          const dayStr = selectedDay.padStart(2, '0');
          dates.push(`${currentYear}-${selectedMonth}-${dayStr}`);
        }

        return dates;
      }

      function findValue(token, date) {
        const tokenData = data[token];
        if (!tokenData) return '';

        const found = tokenData.find(item => item.time === date);
        return found ? found.value.toString().replace('.', ',') : '';
      }

      function formatDate(dateString) {
        const [year, month, day] = dateString.split('-');
        return `${day}.${month}.${year}`;
      }

      function getTokenIcon(token) {
        return `./img/crypto/icons/${token}.svg`;
      }

      function updateTable() {
        const tableHeader = document.querySelector('.table-crypto-header-scroll .table-crypto');
        const tableBody = document.querySelector('.table-crypto-body-scroll .table-crypto');

        tableHeader.innerHTML = '';
        tableBody.innerHTML = '';

        const tokens = selectedToken === 'ALL' ? Object.keys(data) : [selectedToken];
        const dates = getFilteredDates();

        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');

        const tokenHeader = document.createElement('td');
        tokenHeader.textContent = 'Токенизированный актив';
        headerRow.appendChild(tokenHeader);

        dates.forEach(date => {
          const dateHeader = document.createElement('td');
          dateHeader.textContent = formatDate(date);
          headerRow.appendChild(dateHeader);
        });

        thead.appendChild(headerRow);
        tableHeader.appendChild(thead);

        const tbody = document.createElement('tbody');

        tokens.forEach(token => {
          const row = document.createElement('tr');

          const tokenCell = document.createElement('td');
          tokenCell.innerHTML = `${token}`;
          row.appendChild(tokenCell);

          dates.forEach(date => {
            const valueCell = document.createElement('td');
            valueCell.textContent = findValue(token, date);
            row.appendChild(valueCell);
          });

          tbody.appendChild(row);
        });

        tableBody.appendChild(tbody);

        syncScrolls();
      }

      function syncScrolls() {
        const headerScroll = document.querySelector('.table-crypto-header-scroll');
        const bodyScroll = document.querySelector('.table-crypto-body-scroll');

        headerScroll.addEventListener('scroll', function () {
          bodyScroll.scrollLeft = this.scrollLeft;
        });

        bodyScroll.addEventListener('scroll', function () {
          headerScroll.scrollLeft = this.scrollLeft;
        });
      }

      document.addEventListener('DOMContentLoaded', function () {
        syncScrolls();
      });

      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();

        const allTokenItems = document.querySelectorAll('.table-token-item');
        allTokenItems.forEach(item => {
          const text = item.textContent.toLowerCase();
          if (text === 'все' || text.includes(searchTerm)) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
      }

      function initDayEvents() {
        const tableDayItems = document.querySelectorAll('.table-day-item');

        tableDayItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedDay = value;
            tableDayBtn.textContent = this.textContent.trim();
            updateTable();
          });
        });
      }

      function initTokenEvents() {
        const allTokenItems = document.querySelectorAll('.table-token-item');

        allTokenItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedToken = value;
            tableTokenBtn.textContent = this.textContent.trim();
            updateTable();
          });
        });
      }

      function initMonthEvents() {
        const tableMonthItems = document.querySelectorAll('.table-month-item');

        tableMonthItems.forEach(item => {
          item.addEventListener('click', function (e) {
            e.preventDefault();
            const value = this.getAttribute('data-value') || this.textContent.trim();
            selectedMonth = value;
            tableMonthBtn.textContent = this.textContent.trim();
            updateDayState();
            updateDaysList();
            updateTable();
          });
        });
      }

      function addAllTokenOption() {
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-token-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableTokenContainer.insertBefore(allLi, tableTokenContainer.querySelector('.dropdown-search').nextSibling);
      }

      function addAllMonthOption() {
        const allLi = document.createElement('li');
        const allA = document.createElement('a');
        allA.className = 'dropdown-item table-month-item';
        allA.href = '#';
        allA.textContent = 'Все';
        allA.setAttribute('data-value', 'ALL');
        allLi.appendChild(allA);
        tableMonthContainer.insertBefore(allLi, tableMonthContainer.firstChild);
      }

      searchInput.addEventListener('input', performSearch);

      const tokenDropdown = tableTokenBtn.closest('.dropdown');
      tokenDropdown.addEventListener('hidden.bs.dropdown', function () {
        searchInput.value = '';
        const allTokenItems = document.querySelectorAll('.table-token-item');
        allTokenItems.forEach(item => {
          item.style.display = 'block';
        });
      });

      addAllTokenOption();
      addAllMonthOption();
      updateDayState();
      updateDaysList();
      initTokenEvents();
      initMonthEvents();
      initDayEvents();

      tableTokenBtn.textContent = 'Все';
      tableMonthBtn.textContent = 'Все';
      tableDayBtn.textContent = 'Все';

      updateTable();
    });
  </script>


</body>

</html>